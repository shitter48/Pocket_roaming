<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="referrer" content="no-referrer">
    <link href="./bootstrap5/css/bootstrap.css" rel="stylesheet">
    <link href="./css/index.css" rel="stylesheet">
    <link href="./css/jquery.toast.css" rel="stylesheet">
    <script src="./bootstrap5/js/bootstrap.js"></script>
    <script src="./js/jquery.js"></script>
    <link href="../css/main.css" rel="stylesheet">
    
    <!--     <script src = "../js/profiles.js"></script> -->
    <!-- <script src = "../js/profiles_old.js"></script> -->
    <script src="./js/jquery.toast.js"></script>
    <title>Document</title>
    <style>
        /* 限制敘述文字長度 */
        .ellipsis2 {
            overflow: hidden;
            display: -webkit-box;
            text-overflow: ellipsis;
            -webkit-line-clamp: 3;
            /*行數*/
            -webkit-box-orient: vertical;
            white-space: normal;
        }

        .outerBox {
            height: 500px;

            /* 1014-update */
            background-color: lightblue;
            padding: 5px;
        }

        /* 1014-update */
        #carouselExampleIndicators img {
            width: 100%;
            object-fit: cover;
            object-position: top;
        }

        .outerBox img {
            width: 100%;
            object-fit: cover;
        }


        li {
            list-style-type: none;
        }
    </style>
</head>

<body>
    <!-- <div class="container-fluid">
        <div class="row justify-content-center">
            <div class="col-11"> -->
    <!-- top-navbar navbar navbar-expand-sm navbar-dark bg-dark -->
    <nav class="navbar navbar-expand bg-info text-white ">
        <div class="container-fluid">
            <a class="navbar-brand" href="../index.html">
                <img src="./img/LOGO03.png" style="height:50px; width:auto;">
            </a>
            <ul class="nav nav-pills me-auto te mx-1">
                <!-- nav nav-pills -->
                <!-- data-bs-toggle="pill" -->
                <li class="nav-item">
                    <a class="nav-link text-white active fs-4" href="./index.html">首頁</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link text-white fs-4" href="./html/rentflow.html">租借流程</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link text-white fs-4" href="./html/chat.html">聊天室</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link text-white fs-4" href="./html/wishpool.html">許願池</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link text-white fs-4" href="./html/member.html">會員</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link text-white fs-4" href="./html/cart.html">購物車</a>
                </li>
            </ul>
            <!-- 靠右 -->
            <div class="d-flex">
                <div class="btn-group " role="group">
                    <!-- 第一顆按鈕 -->
                    <button id="loginBtn" type="button" class="btn btn-primary fs-4" data-bs-toggle="modal"
                        data-bs-target="#staticBackdrop">登入</button>
                    <button id="logoutBtn" type="submit" style="display:none" class="btn btn-primary fs-4"
                        data-bs-target="#staticBackdrop ">登出</button>
                    <div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false"
                        tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title text-dark fs-4" id="staticBackdropLabel">登入</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal"
                                        aria-label="Close"></button>
                                </div>
                                <form class="text-dark">
                                    <div class="modal-body" id="loginBox">
                                        <label class="mx-2 my-1">帳號</label>
                                        <input class="mx-2 my-1" type="text" id="loginAccountTextBox"
                                            placeholder="請輸入大小寫英數字"><br>
                                        <label class="mx-2 my-1">密碼 </label>
                                        <input class="mx-2 my-1" type="password" id="loginPasswordMTextBox"
                                            placeholder="請輸入大小寫英數字"><br>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn fs-4" id="forgetBtn">忘記密碼？</button>
                                        <button type="button" class="btn btn-secondary fs-4"
                                            data-bs-dismiss="modal">關閉</button>
                                        <button type="button" id="loginMember" class="btn btn-primary fs-4"
                                            data-bs-dismiss="modal">送出</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                    <!-- 第二顆按鈕 -->
                    <button id="createBtn" type="button" class="btn btn-primary fs-4" data-bs-toggle="modal"
                        data-bs-target="#staticBackdrop2">註冊</button>
                    <div class="modal fade" id="staticBackdrop2" data-bs-backdrop="static" data-bs-keyboard="false"
                        tabindex="-1" aria-labelledby="staticBackdropLabel2" aria-hidden="true">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title text-dark" id="staticBackdropLabel2">註冊</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal"
                                        aria-label="Close"></button>
                                </div>

                                <form class="text-dark">
                                    <div class="modal-body">
                                        <label class="mx-2 my-1">帳號</label>
                                        <input class="mx-2 my-1" type="text" id="createAccountTextBox"
                                            placeholder="請輸入大小寫英數字"><br>
                                        <label class="mx-2 my-1">密碼</label>
                                        <input class="mx-2 my-1" type="password" id="createPasswordMTextBox"
                                            placeholder="請輸入大小寫英數字"><br>
                                        <label class="mx-2 my-1">信箱</label>
                                        <input class="mx-2 my-1" type="text" id="createMailTextBox" placeholder=""><br>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary fs-4"
                                            data-bs-dismiss="modal">關閉</button>
                                        <button type="button" id="createMember" class="btn btn-primary fs-4"
                                            data-bs-dismiss="modal">送出</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </nav>
    <!-- main-body -->
    <div class="container-fluid">
        <div class="row justify-content-center">
            <div class="col-11">
                <div>
                    <div class="row">
                        <!-- search-side-bar -->
                        <div class="col-3">
                            <div class="px-2 py-2">
                                <!-- 插入圖片 -->
                                <!--                                 <img src="./img/LOGO01.png"> -->
                                <img src="./img/LOGO02.png" class="col-12 mb-2">
                                <!--                                 <img src="./img/LOGO03.png" class="col-12 mb-2"> -->
                                <!-- 左上半部 -->
                                <div class=" pb-3 ">
                                    <div class="my-2 mx-2 bg-info text-white px-1 pt-1">
                                        <h3>搜尋欄</h2>
                                    </div>
                                    <div class="mx-2 my-2 px-1 py-2 border border-3 ">
                                        <form class="">
                                            <label class="mx-1 my-1">品名搜尋<br />
                                                <input type="text" id="itemName" placeholder="請輸入商品名稱"></label><br />
                                            <label class="mx-1 my-1">標籤搜尋<br />
                                                <input type="text" id="itemTag" placeholder="請輸入標籤"></label><br />
                                            <div class="mx-1 my-1" id="searchByCategory">
                                                <label class="mx-1 my-1">分類搜尋</label><br />
                                                <label class="mx-1 my-1">商品類別<br />
                                                    <input type="radio" name="category_type" value="漫畫">
                                                      <label for="漫畫">漫畫</label>
                                                    <input type="radio" name="category_type" value="小說">
                                                      <label for="小說">小說</label>
                                                    <input type="radio" name="category_type" value="桌遊">
                                                      <label for="桌遊">桌遊</label>
                                                    <input type="radio" name="category_type" value="主機">
                                                      <label for="主機">主機</label>
                                                </label><br />
                                                <div class="mx-1 my-1" id="extraRadio"></div>
                                            </div>
                                            <div class="mx-1">
                                                <label class="mx-1 my-1">價格搜尋
                                                    <input type="number" name="" id="minPrice" placeholder="請輸入最低價格">
                                                    至
                                                    </br>
                                                    <input type="number" name="" id="maxPrice" placeholder="請輸入最高價格"
                                                        class="my-2">
                                                </label>

                                            </div>
                                            <!-- <div class="mx-1 my-1">
                                                <label class="mx-1 my-1">日期</label>
                                                <input value="選擇租借日" id="inputDate1" class="form-control " type="date">
                                            </div> -->
                                            <button type="button" class="btn btn-primary" id="searchItem">搜尋</button>
                                        </form>
                                    </div>
                                </div>
                                <!-- 左下半部 -->
                                <div class="pb-3" hidden>
                                    <div class="mx-2 bg-info text-white px-1 pt-1">
                                        <h3>分類</h3>
                                    </div>
                                    <div class="">
                                        <ul class="list-group mx-1 my-2">
                                            <li><a href="#" class="list-group-item list-group-item-action">123</a></li>
                                            <li><a href="#" class="list-group-item list-group-item-action">123</a></li>
                                            <li><a href="#" class="list-group-item list-group-item-action">123</a></li>
                                            <li><a href="#" class="list-group-item list-group-item-action">123</a></li>
                                            <li><a href="#" class="list-group-item list-group-item-action">123</a></li>
                                            <li><a href="#" class="list-group-item list-group-item-action">123</a></li>
                                            <li><a href="#" class="list-group-item list-group-item-action">123</a></li>
                                            <li><a href="#" class="list-group-item list-group-item-action">123</a></li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="my-3">
                                </div>
                            </div>
                        </div>
                        <!-- show-products -->
                        <div class="col-9">
                            <div id="carouselExampleIndicators" class="carousel carousel-dark slide "
                                data-bs-ride="carousel" style="height: 400px;">
                                <div class="bg-secondary mx-3 my-3">
                                    <div class="carousel-indicators">
                                        <button type="button" data-bs-target="#carouselExampleIndicators"
                                            data-bs-slide-to="0" class="active" aria-current="true"
                                            aria-label="Slide 1"></button>
                                        <button type="button" data-bs-target="#carouselExampleIndicators"
                                            data-bs-slide-to="1" aria-label="Slide 2"></button>
                                        <button type="button" data-bs-target="#carouselExampleIndicators"
                                            data-bs-slide-to="2" aria-label="Slide 3"></button>
                                        <button type="button" data-bs-target="#carouselExampleIndicators"
                                            data-bs-slide-to="3" aria-label="Slide 3"></button>
                                    </div>
                                    <div class="carousel-inner">
                                        <div class="carousel-item active">
                                            <img src="img/PS5.jpg" class="d-block" alt="...">
                                        </div>
                                        <div class="carousel-item">
                                            <img src="img/NARUTO.jpg" class="d-block" alt="...">
                                        </div>
                                        <div class="carousel-item">
                                            <img src="img/killhand.jpg" class="d-block" alt="...">
                                        </div>
                                        <div class="carousel-item">
                                            <img src="img/liter.jpg" class="d-block " alt="...">
                                        </div>
                                    </div>
                                    <button class="carousel-control-prev" type="button"
                                        data-bs-target="#carouselExampleIndicators" data-bs-slide="prev">
                                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                        <span class="visually-hidden">Previous</span>
                                    </button>
                                    <button class="carousel-control-next" type="button"
                                        data-bs-target="#carouselExampleIndicators" data-bs-slide="next">
                                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                        <span class="visually-hidden">Next</span>
                                    </button>
                                </div>
                            </div>

                            <!-- prod card -->
                            <div class="bigbox">
                                <div class="row">
                                    <!-- <div class="col-3">
                                        <div class="px-2 py-3">
                                            <div class="card">
                                                <img src="https://mdbootstrap.com/img/Photos/Horizontal/E-commerce/Products/3.webp"
                                                    class="card-img-top">
                                                <h5 class="text-center card-title">這裡是標題</h5>
                                                <div class="mx-4">
                                                    <span>這裡是簡介
                                                        要塞一些字123143242asdasdasdasdaasdasdasdasasdas342342342342343424qweqeqeqwe2</span>
                                                </div>
                                                <div class="px-3 py-3">
                                                    <div class="d-flex justify-content-between mx-3 my03">
                                                        <span>$100</span>
                                                        <span>加入購物車</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-3">
                                        <div class="px-2 py-3">
                                            <div class="card">
                                                <img src="https://mdbootstrap.com/img/Photos/Horizontal/E-commerce/Products/3.webp"
                                                    class="card-img-top">
                                                <h5 class="text-center card-title">這裡是標題</h5>
                                                <div class="mx-4">
                                                    <span>這裡是簡介
                                                        要塞一些字123143242asdasdasdasdaasdasdasdasasdas342342342342343424qweqeqeqwe2</span>
                                                </div>
                                                <div class="px-3 py-3">
                                                    <div class="d-flex justify-content-between mx-3 my03">
                                                        <span>$100</span>
                                                        <span>加入購物車</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-3">
                                        <div class="px-2 py-3">
                                            <div class="card">
                                                <img src="https://mdbootstrap.com/img/Photos/Horizontal/E-commerce/Products/3.webp"
                                                    class="card-img-top">
                                                <h5 class="text-center card-title">這裡是標題</h5>
                                                <div class="mx-4">
                                                    <span>這裡是簡介
                                                        要塞一些字123143242asdasdasdasdaasdasdasdasasdas342342342342343424qweqeqeqwe2</span>
                                                </div>
                                                <div class="px-3 py-3">
                                                    <div class="d-flex justify-content-between mx-3 my03">
                                                        <span>$100</span>
                                                        <span>加入購物車</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-3">
                                        <div class="px-2 py-3">
                                            <div class="card">
                                                <img src="https://mdbootstrap.com/img/Photos/Horizontal/E-commerce/Products/3.webp"
                                                    class="card-img-top">
                                                <h5 class="text-center card-title">這裡是標題</h5>
                                                <div class="mx-4">
                                                    <span>這裡是簡介
                                                        要塞一些字123143242asdasdasdasdaasdasdasdasasdas342342342342343424qweqeqeqwe2</span>
                                                </div>
                                                <div class="px-3 py-3">
                                                    <div class="d-flex justify-content-between mx-3 my03">
                                                        <span>$100</span>
                                                        <span>加入購物車</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div> -->
                                </div>
                                <div class="row">
                                    <!--
                                    <div class="col-3">
                                        <div class="px-2 py-3">
                                            <div class="card">
                                                <img src="https://mdbootstrap.com/img/Photos/Horizontal/E-commerce/Products/3.webp"
                                                    class="card-img-top">
                                                <h5 class="text-center card-title">這裡是標題</h5>
                                                <div class="mx-4">
                                                    <span>這裡是簡介
                                                        要塞一些字123143242asdasdasdasdaasdasdasdasasdas342342342342343424qweqeqeqwe2</span>
                                                </div>
                                                <div class="px-3 py-3">
                                                    <div class="d-flex justify-content-between mx-3 my03">
                                                        <span>$100</span>
                                                        <span>加入購物車</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-3">
                                        <div class="px-2 py-3">
                                            <div class="card">
                                                <img src="https://mdbootstrap.com/img/Photos/Horizontal/E-commerce/Products/3.webp"
                                                    class="card-img-top">
                                                <h5 class="text-center card-title">這裡是標題</h5>
                                                <div class="mx-4">
                                                    <span>這裡是簡介
                                                        要塞一些字123143242asdasdasdasdaasdasdasdasasdas342342342342343424qweqeqeqwe2</span>
                                                </div>
                                                <div class="px-3 py-3">
                                                    <div class="d-flex justify-content-between mx-3 my03">
                                                        <span>$100</span>
                                                        <span>加入購物車</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-3">
                                        <div class="px-2 py-3">
                                            <div class="card">
                                                <img src="https://mdbootstrap.com/img/Photos/Horizontal/E-commerce/Products/3.webp"
                                                    class="card-img-top">
                                                <h5 class="text-center card-title">這裡是標題</h5>
                                                <div class="mx-4">
                                                    <span>這裡是簡介
                                                        要塞一些字123143242asdasdasdasdaasdasdasdasasdas342342342342343424qweqeqeqwe2</span>
                                                </div>
                                                <div class="px-3 py-3">
                                                    <div class="d-flex justify-content-between mx-3 my03">
                                                        <span>$100</span>
                                                        <span>加入購物車</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-3">
                                        <div class="px-2 py-3">
                                            <div class="card">
                                                <img src="https://mdbootstrap.com/img/Photos/Horizontal/E-commerce/Products/3.webp"
                                                    class="card-img-top">
                                                <h5 class="text-center card-title">這裡是標題</h5>
                                                <div class="mx-4">
                                                    <span>這裡是簡介
                                                        要塞一些字123143242asdasdasdasdaasdasdasdasasdas342342342342343424qweqeqeqwe2</span>
                                                </div>
                                                <div class="px-3 py-3">
                                                    <div class="d-flex justify-content-between mx-3 my03">
                                                        <span>$100</span>
                                                        <span>加入購物車</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div> -->
                                </div>
                            </div>

                        </div>

                    </div>
                </div>

                <!-- foot -->
                <a href="javascript:window.scrollTo(0,0)">
                    <footer class="footer bg-secondary text-center text-white mt-auto fixed-bottom">
                        <!-- <div class="container-fluid"> -->
                        <span class="">2022 EEIT48 </span>
                        <!-- </div> -->
                    </footer>
                </a>
            </div>
        </div>
    </div>


    <!-- function 區域 -->
    <script src="../js/logIn.js"></script>
    <script>
        var items;

        async function downloadAndRefreshUI() {
            var p = $.ajax({
                type: "get",
                url: "/pages/frontCommodity"
            })
            item = await p;

            //返回的JSON資料會存在result
            // newsList = JSON.parse(result);
            items = item.litems;
            iic = item.item_picture;
            refreshUI();

        }
        downloadAndRefreshUI();
        function refreshUI() {
            //             console.log(items.length);
            $(".bigbox").empty();
            console.log(Object.keys(items).length)
            for (let j = 0; j < (items.length + 1) / 4 + 1; j++) {
                //             for (let j = 0; j < (items.length) / 4; j++) {
                //                 console.log(items.length);
                $(".bigbox").append(`<div class="row ${j}"></div>`);
                for (let i = 0; i < ((items.length + 1) / 4) > j ? 4 : (items.length); i++) {
                    //                 for (let i = 0; i <= j; i++) {
                    //                     console.log(items.length);

                    //商品圖片
                    //                     console.log(iic)
                    console.log(i + " " + j)
                    //                     console.log(iic[i + j * 4])
                    let src = iic[i + j * 4]["picture_url"];
                    //                     console.log(src);
                    let newsItem = items[i + j * 4];

                    //商品item_id 用來做連結到CART 跟商品頁面
                    let item_id = newsItem.item_id;
                    //商品敘述
                    let item_description = `${newsItem.item_description}`;
                    //商品名稱
                    let item_name = `${newsItem.item_name}`;
                    //商品狀態
                    let item_state_id = `${newsItem.item_state_id}`
                    //商品價格
                    let item_price = `${newsItem.item_price}`
                    let liTemplate = `<div class="col-3">
                                <div class="px-2 py-3">
                                    <div class="card outerBox">
                                      <a><img src="../img/${src}" data-value="${item_id}" class="img-fluid rounded-3 enterProduct" style="height:300px;width:auto;margin:auto" ></a>
                                        <p class="text-center card-title fs-2"> ${item_name}</p>
                                        <div class="mx-4">
                                            <span class="ellipsis2">${item_description}</span>
                                        </div>
                                        <div class="px-3 py-3">
                                            <div class="d-flex justify-content-between mx-3 my03">
                                                <span>${item_price}</span>                                              
                                                <button class="addCart btn btn-primary" name="${item_id}">加入購物車</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>  `;
                    $(`.${j}`).append(liTemplate);
                    //進入商品頁面 把item_id 存到LocalStorage到商品頁面再用AJAX取回對應資料

                    $(".enterProduct").click(function () {
                        localStorage.setItem("item_id", $(this).attr("data-value"));
                        location.href = "html/product.html";
                    })

                }
                //加到購物車

            }

        }
        $(".bigbox").on("click", ".addCart", function () {
            //                     console.log($(this).attr("name"));
            var items_id = $(this).attr("name")
            var p = $.ajax({
                type: "post",
                url: "/addInCart",
                data: {
                    items_id: items_id
                }
            })
            alert("加入購物車");
        })   
    </script>
    <script>
        var r;
        function refreshUIs() {
            //   console.log(r);
            //               console.log(r.itps);
            //   console.log(r.itps[0][0].picture_url);
            $(".bigbox").empty();
            var its
            console.log(its)
            // if (its != "" && its != null && its != undefined) {
            for (let j = 0; j < r.its.length + 1 / 4 + 1; j++) {
                $(".bigbox").append(`<div class="row ${j}"></div>`);
                for (let i = 0; i < ((r.itps.length + 1) / 4) > j ? 4 : (r.itps.length); i++) {

                    //商品圖片
                    let src = r.itps[i + j * 4][0].picture_url;
                    //                     console.log(src);
                    let newsItem = r.its[i + j * 4];

                    //商品item_id 用來做連結到CART 跟商品頁面
                    let item_id = newsItem.item_id;
                    //商品敘述
                    let item_description = `${newsItem.item_description}`;
                    //商品名稱
                    let item_name = `${newsItem.item_name}`;
                    //商品狀態
                    let item_state_id = `${newsItem.item_state_id}`
                    //商品價格
                    let item_price = `${newsItem.item_price}`
                    let liTemplate = `<div class="col-3">
                                    <div class="px-2 py-3">
                                        <div class="card outerBox">
                                        <a><img src="../img/${src}" data-value="${item_id}" class="img-fluid rounded-3 enterProduct" style="height:300px;width:auto;margin:auto" ></a>
                                            <p class="text-center card-title fs-2"> ${item_name}</p>
                                            <div class="mx-4">
                                                <span class="ellipsis2">${item_description}</span>
                                            </div>
                                            <div class="px-3 py-3">
                                                <div class="d-flex justify-content-between mx-3 my03">
                                                    <span>${item_price}</span>                                              
                                                    <button class="addCart" name="${item_id}">加入購物車</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>  `;
                    $(`.${j}`).append(liTemplate);
                    //進入商品頁面 把item_id 存到LocalStorage到商品頁面再用AJAX取回對應資料

                    $(".enterProduct").click(function () {
                        localStorage.setItem("item_id", $(this).attr("data-value"));
                        location.href = "html/product.html";
                    })


                }
                // $(".bigbox").append(`</div>`)
            }
        }
        //加到購物車
        $(".addCart").click(function () {
            //                 console.log($(this).attr("name"));
            var items_id = $(this).attr("name")
            var p = $.ajax({
                type: "post",
                url: "/addInCart",
                data: {
                    items_id: items_id
                }
            })
        })

        $("#itemName").on("input", function () {
            $("#itemTag").val("");
            $("#minPrice").val("");
            $("#maxPrice").val("");
            var radio = document.querySelector("input[name=category_type]:checked");
            radio.checked = false;
            $("#extraRadio").empty();
        })
        $("#itemTag").on("input", function () {
            $("#itemName").val("");
            $("#minPrice").val("");
            $("#maxPrice").val("");
            var radio = document.querySelector("input[name=category_type]:checked");
            radio.checked = false;
            $("#extraRadio").empty();
        })
        $("#minPrice").on("input", function () {
            $("#itemName").val("");
            $("#itemTag").val("");
            var radio = document.querySelector("input[name=category_type]:checked");
            radio.checked = false;
            $("#extraRadio").empty();
        })
        $("#maxPrice").on("input", function () {
            $("#itemName").val("");
            $("#itemTag").val("");
            var radio = document.querySelector("input[name=category_type]:checked");
            radio.checked = false;
            $("#extraRadio").empty();
        })

        $("#searchItem").on("click", async function () {
            if ($("#itemName").val() != "") {
                var postdata = {
                    item_name: $("#itemName").val()
                }
                var temp = $.ajax({
                    type: "post",
                    url: "/api/searchItem/itemName",
                    data: postdata
                })
                r = await temp;
                //                 console.log(r);
            } else if ($("#itemTag").val() != "") {
                var postdata = {
                    item_tag: $("#itemTag").val()
                }
                var temp = $.ajax({
                    type: "post",
                    url: "/api/searchItem/itemTag",
                    data: postdata
                })
                r = await temp;
                //                 console.log(r);
            } else if ($("#minPrice").val() != "" && $("#maxPrice").val() != "") {
                var temp = $.ajax({
                    type: "get",
                    url: "/api/searchItem/price/" + $("#minPrice").val() + "/" + $("#maxPrice").val()
                })
                r = await temp;
                //                 console.log(r);
            } else if ($("[name='category_type']:checked").val()) {
                switch ($("[name='category_type']:checked").val()) {
                    case "漫畫":
                        var postdata = {};
                        var temp;
                        if ($("[name='comic_type']:checked").val()) {
                            postdata = {
                                category_name:
                                    $("[name='category_region']:checked").val() +
                                    $("[name='comic_type']:checked").val() +
                                    $("[name='category_type']:checked").val()
                            }
                            temp = $.ajax({
                                type: "post",
                                url: "/api/searchItem/itemCategory",
                                data: postdata
                            })
                        } else if ($("[name='category_region']:checked").val()) {
                            postdata = {
                                name01: $("[name='category_type']:checked").val(),
                                name02: $("[name='category_region']:checked").val()
                            }
                            temp = $.ajax({
                                type: "post",
                                url: "/api/searchItem/itemPartCategory",
                                data: postdata
                            })
                        } else {
                            postdata = {
                                category_name: $("[name='category_type']:checked").val()
                            }
                            temp = $.ajax({
                                type: "post",
                                url: "/api/searchItem/itemCategory",
                                data: postdata
                            })
                        }

                        r = await temp;
                        //                         console.log(r);
                        break;
                    case "小說":
                        var postdata = {};
                        var temp;
                        if ($("[name='novel_type']:checked").val()) {
                            if ($("[name='novel_type']:checked").val() == "純文學") {
                                postdata = {
                                    category_name:
                                        $("[name='category_region']:checked").val() +
                                        $("[name='novel_type']:checked").val()
                                }
                            } else {
                                postdata = {
                                    category_name:
                                        $("[name='category_region']:checked").val() +
                                        $("[name='novel_type']:checked").val() +
                                        $("[name='category_type']:checked").val()
                                }
                            }

                            temp = $.ajax({
                                type: "post",
                                url: "/api/searchItem/itemCategory",
                                data: postdata
                            })
                        } else if ($("[name='category_region']:checked").val()) {
                            postdata = {
                                name01: $("[name='category_type']:checked").val(),
                                name02: $("[name='category_region']:checked").val()
                            }
                            temp = $.ajax({
                                type: "post",
                                url: "/api/searchItem/itemPartCategory",
                                data: postdata
                            })
                        } else {
                            postdata = {
                                category_name: $("[name='category_type']:checked").val()
                            }
                            temp = $.ajax({
                                type: "post",
                                url: "/api/searchItem/itemCategory",
                                data: postdata
                            })
                        }

                        r = await temp;
                        //                         console.log(r);
                        break;
                    case "桌遊":
                        var postdata = {};
                        var temp;
                        if ($("[name='boardgame_type']:checked").val()) {
                            postdata = {
                                category_name:
                                    $("[name='boardgame_size']:checked").val() +
                                    $("[name='boardgame_type']:checked").val() +
                                    $("[name='category_type']:checked").val()
                            }
                            temp = $.ajax({
                                type: "post",
                                url: "/api/searchItem/itemCategory",
                                data: postdata
                            })
                        } else if ($("[name='boardgame_size']:checked").val()) {
                            postdata = {
                                name01: $("[name='category_type']:checked").val(),
                                name02: $("[name='boardgame_size']:checked").val()
                            }
                            temp = $.ajax({
                                type: "post",
                                url: "/api/searchItem/itemPartCategory",
                                data: postdata
                            })
                        } else {
                            postdata = {
                                category_name: $("[name='category_type']:checked").val()
                            }
                            temp = $.ajax({
                                type: "post",
                                url: "/api/searchItem/itemCategory",
                                data: postdata
                            })
                        }

                        r = await temp;
                        //                         console.log(r);
                        break;
                    case "主機":
                        var postdata = {};
                        if ($("[name='console_type']:checked").val()) {
                            postdata = {
                                category_name: $("[name='console_type']:checked").val()
                            }
                        } else {
                            postdata = {
                                category_name: $("[name='category_type']:checked").val()
                            }
                        }
                        var temp = $.ajax({
                            type: "post",
                            url: "/api/searchItem/itemCategory",
                            data: postdata
                        })
                        r = await temp;
                        //                         console.log(r);
                        break;
                }

            }
            refreshUIs();
        })
        $("[name='category_type']").change(function () {
            $("#itemName").val("");
            $("#itemTag").val("");
            $("#minPrice").val("");
            $("#maxPrice").val("");
            function showRegion() {
                $("#extraRadio").empty();
                $("#extraRadio").append(
                    '<label class="mx-1 my-1">地區</label><br />' +
                    '<input type="radio" name="category_region" value="台灣">' +
                    '<label for="台灣">台灣</label>' +
                    '<input type="radio" name="category_region" value="香港">' +
                    '<label for="香港">香港</label>' +
                    '<input type="radio" name="category_region" value="日本">' +
                    '<label for="日本">日本</label>' +
                    '<input type="radio" name="category_region" value="韓國">' +
                    '<label for="韓國">韓國</label><br>' +
                    '<input type="radio" name="category_region" value="中國">' +
                    '<label for="中國">中國</label>' +
                    '<input type="radio" name="category_region" value="美國">' +
                    '<label for="美國">美國</label>' +
                    '<input type="radio" name="category_region" value="歐洲">' +
                    '<label for="歐洲">歐洲</label>' +
                    '<input type="radio" name="category_region" value="其他">' +
                    '<label for="其他">其他</label><br>' +
                    '<div id="typeRadio"></div>'
                )
            }
            switch ($("[name='category_type']:checked").val()) {
                case "漫畫":
                    showRegion();
                    $("[name='category_region']").change(function () {
                        $("#typeRadio").empty();
                        $("#typeRadio").append(
                            '<label class="mx-1 my-1">類別</label><br />' +
                            '<input type="radio" name="comic_type" value="熱血">' +
                            '<label for="熱血">熱血</label>' +
                            '<input type="radio" name="comic_type" value="冒險">' +
                            '<label for="冒險">冒險</label>' +
                            '<input type="radio" name="comic_type" value="奇幻">' +
                            '<label for="奇幻">奇幻</label>' +
                            '<input type="radio" name="comic_type" value="科幻">' +
                            '<label for="科幻">科幻</label>' +
                            '<input type="radio" name="comic_type" value="競技">' +
                            '<label for="競技">競技</label>' +
                            '<input type="radio" name="comic_type" value="運動">' +
                            '<label for="運動">運動</label>' +
                            '<input type="radio" name="comic_type" value="校園">' +
                            '<label for="校園">校園</label>' +
                            '<input type="radio" name="comic_type" value="歷史">' +
                            '<label for="歷史">歷史</label>' +
                            '<input type="radio" name="comic_type" value="推理">' +
                            '<label for="推理">推理</label>' +
                            '<input type="radio" name="comic_type" value="懸疑">' +
                            '<label for="懸疑">懸疑</label>' +
                            '<input type="radio" name="comic_type" value="恐怖">' +
                            '<label for="恐怖">恐怖</label>' +
                            '<input type="radio" name="comic_type" value="美食">' +
                            '<label for="美食">美食</label>' +
                            '<input type="radio" name="comic_type" value="戀愛">' +
                            '<label for="戀愛">戀愛</label>' +
                            '<input type="radio" name="comic_type" value="日常">' +
                            '<label for="日常">日常</label>' +
                            '<input type="radio" name="comic_type" value="音樂">' +
                            '<label for="音樂">音樂</label>' +
                            '<input type="radio" name="comic_type" value="治癒">' +
                            '<label for="治癒">治癒</label>' +
                            '<input type="radio" name="comic_type" value="社會">' +
                            '<label for="社會">社會</label>' +
                            '<input type="radio" name="comic_type" value="搞笑">' +
                            '<label for="搞笑">搞笑</label>' +
                            '<input type="radio" name="comic_type" value="萌系">' +
                            '<label for="萌系">萌系</label>' +
                            '<input type="radio" name="comic_type" value="後宮">' +
                            '<label for="後宮">後宮</label>' +
                            '<input type="radio" name="comic_type" value="BL">' +
                            '<label for="BL">BL</label>' +
                            '<input type="radio" name="comic_type" value="GL">' +
                            '<label for="GL">GL</label>' +
                            '<input type="radio" name="comic_type" value="四格">' +
                            '<label for="四格">四格</label>' +
                            '<input type="radio" name="comic_type" value="武俠">' +
                            '<label for="武俠">武俠</label>' +
                            '<input type="radio" name="comic_type" value="格鬥">' +
                            '<label for="格鬥">格鬥</label>' +
                            '<input type="radio" name="comic_type" value="機戰">' +
                            '<label for="機戰">機戰</label>' +
                            '<input type="radio" name="comic_type" value="同人">' +
                            '<label for="同人">同人</label>' +
                            '<input type="radio" name="comic_type" value="溫馨">' +
                            '<label for="溫馨">溫馨</label>' +
                            '<input type="radio" name="comic_type" value="獵奇">' +
                            '<label for="獵奇">獵奇</label>' +
                            '<input type="radio" name="comic_type" value="其他">' +
                            '<label for="其他">其他</label>'
                        )
                    })

                    break;
                case "小說":
                    showRegion();
                    $("[name='category_region']").change(function () {
                        $("#typeRadio").empty();
                        $("#typeRadio").append(
                            '<label class="mx-1 my-1">類別</label><br />' +
                            '<input type="radio" name="novel_type" value="奇幻">' +
                            '<label for="奇幻">奇幻</label>' +
                            '<input type="radio" name="novel_type" value="科幻">' +
                            '<label for="科幻">科幻</label>' +
                            '<input type="radio" name="novel_type" value="玄幻">' +
                            '<label for="玄幻">玄幻</label>' +
                            '<input type="radio" name="novel_type" value="歷史">' +
                            '<label for="歷史">歷史</label>' +
                            '<input type="radio" name="novel_type" value="武俠">' +
                            '<label for="武俠">武俠</label>' +
                            '<input type="radio" name="novel_type" value="推理 ">' +
                            '<label for="推理">推理</label>' +
                            '<input type="radio" name="novel_type" value="懸疑">' +
                            '<label for="懸疑">懸疑</label>' +
                            '<input type="radio" name="novel_type" value="恐怖">' +
                            '<label for="恐怖">恐怖</label>' +
                            '<input type="radio" name="novel_type" value="言情">' +
                            '<label for="言情">言情</label>' +
                            '<input type="radio" name="novel_type" value="穿越">' +
                            '<label for="穿越">穿越</label>' +
                            '<input type="radio" name="novel_type" value="古典">' +
                            '<label for="古典">古典</label>' +
                            '<input type="radio" name="novel_type" value="輕">' +
                            '<label for="輕">輕小說</label>' +
                            '<input type="radio" name="novel_type" value="同人">' +
                            '<label for="同人">同人</label>' +
                            '<input type="radio" name="novel_type" value="純文學">' +
                            '<label for="純文學">純文學</label>' +
                            '<input type="radio" name="novel_type" value="其他">' +
                            '<label for="其他">其他</label>'
                        )
                    })

                    break;
                case "桌遊":
                    $("#extraRadio").empty();
                    $("#extraRadio").append(
                        '<label class="mx-1 my-1">大小<br />' +
                        '<input type="radio" name="boardgame_size" value="01">' +
                        '<label for="01">小型</label>' +
                        '<input type="radio" name="boardgame_size" value="02">' +
                        '<label for="02">中型</label>' +
                        '<input type="radio" name="boardgame_size" value="06">' +
                        '<label for="03">大型</label><br>' +
                        '<div id="typeRadio"></div>'
                    )
                    $("[name='boardgame_size']").change(function () {
                        $("#typeRadio").empty();
                        $("#typeRadio").append(
                            '<label class="mx-1 my-1">類別<br />' +
                            '<input type="radio" name="boardgame_type" value="兒童">' +
                            '<label for="兒童">兒童</label>' +
                            '<input type="radio" name="boardgame_type" value="家庭">' +
                            '<label for="家庭">家庭</label>' +
                            '<input type="radio" name="boardgame_type" value="派對">' +
                            '<label for="派對">派對</label><br>' +
                            '<input type="radio" name="boardgame_type" value="陣營">' +
                            '<label for="陣營">陣營</label>' +
                            '<input type="radio" name="boardgame_type" value="策略">' +
                            '<label for="策略">策略</label>' +
                            '<input type="radio" name="boardgame_type" value="主題">' +
                            '<label for="主題">主題</label><br>' +
                            '<input type="radio" name="boardgame_type" value="抽象">' +
                            '<label for="抽象">抽象</label>' +
                            '<input type="radio" name="boardgame_type" value="集換">' +
                            '<label for="集換">集換</label>'
                        )
                    })

                    break;
                case "主機":
                    $("#extraRadio").empty();
                    $("#extraRadio").append(
                        '<label class="mx-1 my-1">類別<br />' +
                        '<input type="radio" name="console_type" value="0001">' +
                        '<label for="0001">家用主機</label>' +
                        '<input type="radio" name="console_type" value="0002 ">' +
                        '<label for="0002">掌上主機</label>' +
                        '<input type="radio" name="console_type" value="0003">' +
                        '<label for="0003">大型機台</label><br>'
                    )
                    break;
            }
        })</script>
</body>